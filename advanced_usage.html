

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advanced Usage and Customization &mdash; VGSLify 0.14.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=82662543"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="vgslify package" href="source/vgslify.html" />
    <link rel="prev" title="Converting Models Back to VGSL Spec" href="convert_to_vgsl_spec.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            VGSLify
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="supported_layers.html">Supported Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="convert_to_vgsl_spec.html">Converting Models Back to VGSL Spec</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced Usage and Customization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#custom-layer-registration">Custom Layer Registration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-custom-layers-work">How Custom Layers Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensorflow-example">TensorFlow Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pytorch-example">PyTorch Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-custom-layers-in-a-vgsl-spec">Using Custom Layers in a VGSL Spec</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#custom-parser-registration">Custom Parser Registration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#why-register-a-custom-parser">Why Register a Custom Parser?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-custom-parsers-work">How Custom Parsers Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensorflow-model-parser-example">TensorFlow Model Parser Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pytorch-model-parser-example">PyTorch Model Parser Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#full-round-trip-support">Full Round-Trip Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#extending-model-conversion">Extending Model Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-and-best-practices">Debugging and Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integrating-vgslify-in-larger-workflows">Integrating VGSLify in Larger Workflows</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="source/vgslify.html">vgslify package</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/vgslify.core.html">vgslify.core package</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/vgslify.model_parsers.html">vgslify.model_parsers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/vgslify.tensorflow.html">vgslify.tensorflow package</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/vgslify.torch.html">vgslify.torch package</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/vgslify.utils.html">vgslify.utils package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VGSLify</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Advanced Usage and Customization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/advanced_usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="advanced-usage-and-customization">
<h1>Advanced Usage and Customization<a class="headerlink" href="#advanced-usage-and-customization" title="Link to this heading"></a></h1>
<p>VGSLify is designed to be highly extensible. This section covers advanced topics such as:</p>
<ul class="simple">
<li><p>Registering <strong>custom layers</strong> to extend VGSLify’s capabilities.</p></li>
<li><p>Creating <strong>custom parsers</strong> to enable VGSL spec conversion for non-standard layers.</p></li>
<li><p>Debugging VGSL strings and best practices for troubleshooting.</p></li>
</ul>
<section id="custom-layer-registration">
<h2>Custom Layer Registration<a class="headerlink" href="#custom-layer-registration" title="Link to this heading"></a></h2>
<p>VGSLify allows you to extend its functionality by registering <strong>custom layer builder functions</strong>. This is especially useful if you need to add experimental or framework-specific layers.</p>
<section id="how-custom-layers-work">
<h3>How Custom Layers Work<a class="headerlink" href="#how-custom-layers-work" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Decorators and Prefixes</strong>: Register a custom layer using <cite>&#64;register_custom_layer(“&lt;prefix&gt;”)</cite>.</p>
<ul class="simple">
<li><p>The prefix is a short identifier (e.g., <cite>“Xcustom”</cite>) used in the VGSL spec.</p></li>
</ul>
</li>
<li><p><strong>Function Signature</strong>: The builder function must accept:</p>
<ul class="simple">
<li><p><cite>factory</cite>: A <cite>TensorFlowLayerFactory</cite> or <cite>TorchLayerFactory</cite> instance.</p></li>
<li><p><cite>spec</cite>: The entire VGSL token that starts with your custom prefix.</p></li>
</ul>
</li>
<li><p><strong>Return Value</strong>: Your function must return a valid layer:</p>
<ul class="simple">
<li><p><strong>TensorFlow</strong>: A <cite>tf.keras.layers.Layer</cite> or <cite>tf.keras.Sequential</cite> model.</p></li>
<li><p><strong>PyTorch</strong>: An <cite>nn.Module</cite> or <cite>nn.Sequential</cite> module.</p></li>
</ul>
</li>
</ol>
<p>Once registered, if VGSLify encounters a VGSL spec token with your prefix (e.g., <cite>“Xcustom”</cite>), it will call your function to construct the layer.</p>
</section>
<section id="tensorflow-example">
<h3>TensorFlow Example<a class="headerlink" href="#tensorflow-example" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">vgslify.tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_custom_layer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>

<span class="nd">@register_custom_layer</span><span class="p">(</span><span class="s2">&quot;Xcustom&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">build_custom_layer</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a custom TensorFlow layer or layer block.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    factory : TensorFlowLayerFactory</span>
<span class="sd">        The factory object that manages layer creation in TensorFlow.</span>
<span class="sd">    spec : str</span>
<span class="sd">        The VGSL spec token starting with &#39;Xcustom&#39;. Example: &quot;Xcustom,128&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tf.keras.layers.Layer</span>
<span class="sd">        A valid TensorFlow layer or Sequential model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dense</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">bn</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">dense</span><span class="p">,</span>
        <span class="n">bn</span><span class="p">,</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
    <span class="p">])</span>
</pre></div>
</div>
</section>
<section id="pytorch-example">
<h3>PyTorch Example<a class="headerlink" href="#pytorch-example" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">vgslify.torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_custom_layer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="nd">@register_custom_layer</span><span class="p">(</span><span class="s2">&quot;Xcustom&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">build_custom_layer</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a custom PyTorch layer or module.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    factory : TorchLayerFactory</span>
<span class="sd">        The factory object that manages layer creation in PyTorch.</span>
<span class="sd">    spec : str</span>
<span class="sd">        The VGSL spec token starting with &#39;Xcustom&#39;. Example: &quot;Xcustom,128&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nn.Module</span>
<span class="sd">        A valid PyTorch module or Sequential model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">in_features</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># The current output shape from the previous layer</span>
    <span class="n">linear</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="n">dropout</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">activation</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">dropout</span><span class="p">,</span> <span class="n">activation</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-custom-layers-in-a-vgsl-spec">
<h3>Using Custom Layers in a VGSL Spec<a class="headerlink" href="#using-custom-layers-in-a-vgsl-spec" title="Link to this heading"></a></h3>
<p>Once registered, you can use the custom prefix in a VGSL spec:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>None,28,28,1 Cr3,3,32 Xcustom Mp2,2 Rc2 Fr64 Fs10
</pre></div>
</div>
<p>When <cite>VGSLModelGenerator</cite> processes <cite>“Xcustom”</cite>, it will call the corresponding <cite>build_custom_layer()</cite> function.</p>
</section>
</section>
<section id="custom-parser-registration">
<h2>Custom Parser Registration<a class="headerlink" href="#custom-parser-registration" title="Link to this heading"></a></h2>
<p>VGSLify also supports <strong>custom model parsers</strong>, which enable conversion from deep learning models back to VGSL spec strings.</p>
<section id="why-register-a-custom-parser">
<h3>Why Register a Custom Parser?<a class="headerlink" href="#why-register-a-custom-parser" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>For non-standard layers</strong>: If you have proprietary or experimental layers, the built-in parser may not recognize them.</p></li>
<li><p><strong>For accurate model conversion</strong>: You define how the layer should be represented in VGSL format.</p></li>
</ul>
</section>
<section id="how-custom-parsers-work">
<h3>How Custom Parsers Work<a class="headerlink" href="#how-custom-parsers-work" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Decorator-Based Registration</strong>: Use <cite>&#64;register_custom_parser(SomeLayerClass)</cite>.</p></li>
<li><p><strong>Function Signature</strong>:</p>
<ul class="simple">
<li><p><cite>layer</cite>: The actual layer instance from a <cite>tf.keras.Model</cite> or <cite>nn.Module</cite>.</p></li>
<li><p><strong>Return</strong>: A valid VGSL spec token (e.g., <cite>“XmyLayer,128”</cite>).</p></li>
</ul>
</li>
</ol>
</section>
<section id="tensorflow-model-parser-example">
<h3>TensorFlow Model Parser Example<a class="headerlink" href="#tensorflow-model-parser-example" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">vgslify.model_parsers.tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_custom_parser</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyCustomKerasLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="c1"># Custom layer logic here</span>
    <span class="k">pass</span>

<span class="nd">@register_custom_parser</span><span class="p">(</span><span class="n">MyCustomKerasLayer</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_my_custom_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts MyCustomKerasLayer instance to a VGSL spec string.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    layer : MyCustomKerasLayer</span>
<span class="sd">        The actual layer instance from a tf.keras.Model.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A VGSL spec token such as &quot;XmyLayer&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;XmyLayer&quot;</span>
</pre></div>
</div>
</section>
<section id="pytorch-model-parser-example">
<h3>PyTorch Model Parser Example<a class="headerlink" href="#pytorch-model-parser-example" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">vgslify.model_parsers.torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_custom_parser</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyCustomTorchLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

<span class="nd">@register_custom_parser</span><span class="p">(</span><span class="n">MyCustomTorchLayer</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_my_custom_torch_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts MyCustomTorchLayer instance to a VGSL spec token.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    layer : MyCustomTorchLayer</span>
<span class="sd">        The actual PyTorch layer instance from an nn.Module.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A VGSL spec token like &quot;XmyTorchLayer,64&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_features</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">out_features</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;XmyTorchLayer,</span><span class="si">{</span><span class="n">out_features</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="full-round-trip-support">
<h3>Full Round-Trip Support<a class="headerlink" href="#full-round-trip-support" title="Link to this heading"></a></h3>
<p>If both a <strong>custom layer builder</strong> and a <strong>custom parser</strong> are registered:</p>
<ul class="simple">
<li><p>You can <strong>build</strong> models from VGSL specs that contain <cite>“XmyLayer”</cite>.</p></li>
<li><p>You can <strong>convert</strong> models back to VGSL spec, ensuring the same <cite>“XmyLayer”</cite> appears in the output.</p></li>
</ul>
</section>
</section>
<section id="extending-model-conversion">
<h2>Extending Model Conversion<a class="headerlink" href="#extending-model-conversion" title="Link to this heading"></a></h2>
<p>VGSLify provides the <code class="docutils literal notranslate"><span class="pre">model_to_spec()</span></code> utility to convert existing models back into VGSL specifications. Advanced users can modify the output spec string to tweak or optimize the architecture. This is particularly useful for:</p>
<ul class="simple">
<li><p><strong>Reproducing models</strong>: Share a compact spec string instead of verbose code.</p></li>
<li><p><strong>Architecture search</strong>: Programmatically adjust VGSL strings and rebuild models for hyperparameter tuning.</p></li>
<li><p><strong>Debugging</strong>: Compare the generated spec with your intended design.</p></li>
</ul>
</section>
<section id="debugging-and-best-practices">
<h2>Debugging and Best Practices<a class="headerlink" href="#debugging-and-best-practices" title="Link to this heading"></a></h2>
<p>When working with VGSL strings:</p>
<ul>
<li><p><strong>Validate Your Spec</strong>: Use simple, incremental specs. Start with an input layer and add one layer at a time, verifying the output shape.</p></li>
<li><p><strong>Use the Generator History</strong>: The <code class="docutils literal notranslate"><span class="pre">generate_history()</span></code> method of <code class="docutils literal notranslate"><span class="pre">VGSLModelGenerator</span></code> returns a list of intermediate layers. This can help you inspect and debug layer shapes before building the final model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vgsl_gn</span> <span class="o">=</span> <span class="n">VGSLModelGenerator</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">vgsl_gn</span><span class="o">.</span><span class="n">generate_history</span><span class="p">(</span><span class="s2">&quot;None,28,28,1 Cr3,3,32 Mp2,2 Rc2 Fr64 D20 Fs10&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">history</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Layer </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">layer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Custom Parsers</strong>: Advanced users may want to write custom parsers for new types of layers. Both the TensorFlow and PyTorch model parsers support decorators for custom parser registration. Check the source code and examples in the corresponding modules.</p></li>
</ul>
<p>Best Practices Summary:</p>
<blockquote>
<div><ul class="simple">
<li><p>Start simple and test each layer’s output shape.</p></li>
<li><p>Use custom registrations to keep your VGSL strings clean.</p></li>
<li><p>Convert models back to VGSL specs to verify consistency.</p></li>
<li><p>Leverage the history method to debug complex architectures.</p></li>
</ul>
</div></blockquote>
</section>
<section id="integrating-vgslify-in-larger-workflows">
<h2>Integrating VGSLify in Larger Workflows<a class="headerlink" href="#integrating-vgslify-in-larger-workflows" title="Link to this heading"></a></h2>
<p>VGSLify’s design encourages easy integration with existing deep learning pipelines. For instance, after generating a model, you can directly plug it into your training framework or integrate it with experiment tracking tools like TensorBoard or Weights &amp; Biases.</p>
<p>Example integration with TensorBoard:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">vgslify</span><span class="w"> </span><span class="kn">import</span> <span class="n">VGSLModelGenerator</span>

<span class="n">vgsl_spec</span> <span class="o">=</span> <span class="s2">&quot;None,28,28,1 Cr3,3,32 Mp2,2 Rc2 Fr64 D20 Fs10&quot;</span>
<span class="n">vgsl_gn</span> <span class="o">=</span> <span class="n">VGSLModelGenerator</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">vgsl_gn</span><span class="o">.</span><span class="n">generate_model</span><span class="p">(</span><span class="n">vgsl_spec</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">tensorboard_callback</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">TensorBoard</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">tensorboard_callback</span><span class="p">])</span>
</pre></div>
</div>
<p>This flexibility makes VGSLify suitable not only for prototyping but also for production-level model management.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="convert_to_vgsl_spec.html" class="btn btn-neutral float-left" title="Converting Models Back to VGSL Spec" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="source/vgslify.html" class="btn btn-neutral float-right" title="vgslify package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Tim Koornstra.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>